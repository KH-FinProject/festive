<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
	namespace="com.project.festive.festiveserver.myPage.model.mapper.MyPageMapper">

	<!-- 회원의 비밀번호 조회 -->
	<select id="selectPw">
		SELECT PASSWORD
		FROM "MEMBER"
		WHERE MEMBER_NO =
		#{memberNo}
	</select>

	<!-- 회원 비밀번호 변경 -->
	<update id="changePw">
		UPDATE "MEMBER" SET
		PASSWORD = #{newEncodedPw}
		WHERE MEMBER_NO = #{memberNo}
	</update>


	<!-- 회원 탈퇴 -->
	<update id="withdrawal">
		UPDATE "MEMBER" SET
		MEMBER_DEL_FL = 'Y'
		WHERE MEMBER_NO
		= #{memberNo}
	</update>


	<!-- 내가 작성한 게시글 조회 -->
	<select id="selectMyPosts">
		SELECT
		B.BOARD_NO AS boardNo,
		B.BOARD_TITLE AS boardTitle,
		B.BOARD_CREATE_DATE AS boardCreateDate,
		B.BOARD_VIEW_COUNT AS boardViewCount,
		M.NICKNAME AS memberNickname,
		B.BOARD_LIKE_COUNT AS boardLikeCount
		FROM BOARD B
		JOIN MEMBER M ON B.MEMBER_NO = M.MEMBER_NO
		WHERE B.MEMBER_NO = #{memberNo}
		AND B.BOARD_DELETE_YN = 'N'
		ORDER BY B.BOARD_CREATE_DATE DESC
	</select>


	<!-- 내가 작성한 댓글 조회 -->
	<select id="selectMyComments">
		SELECT M.NICKNAME AS memberNickname, *
		FROM "COMMENT"
		JOIN MEMBER M ON B.MEMBER_NO = M.MEMBER_NO
		WHERE "MEMBER_NO" = #{memberNo}
		AND "COMMENT_DEL_FL" = 'N'
		ORDER BY "COMMENT_WRITE_DATE" DESC
	</select>

	<select id="selectMyInfo">
		SELECT MEMBER_NO, MEMBER_PHONE, MEMBER_EMAIL, MEMBER_ADDRESS,
		MEMBER_DETAIL_ADDRESS, MEMBER_POST_CODE
		FROM MEMBER
		WHERE MEMBER_NO = #{memberNo}
	</select>

	<update id="updateMyInfo">
		UPDATE MEMBER
		SET
		MEMBER_PHONE = #{memberPhone},
		MEMBER_EMAIL = #{memberEmail},
		MEMBER_ADDRESS = #{memberAddress},
		MEMBER_DETAIL_ADDRESS = #{memberDetailAddress},
		MEMBER_POST_CODE = #{memberPostCode}
		WHERE MEMBER_NO = #{memberNo}
	</update>

</mapper>